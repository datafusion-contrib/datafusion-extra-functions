# MAX_BY and MIN_BY test cases


# Test max_by with numbers
query I
SELECT max_by(x, y) FROM VALUES (1, 10), (2, 5), (3, 15), (4, 8) as tab(x, y);
----
3

# Test min_by with numbers
query I
SELECT min_by(x, y) FROM VALUES (1, 10), (2, 5), (3, 15), (4, 8) as tab(x, y);
----
2

# Test max_by with strings
query I
SELECT max_by(name, length(name)) FROM VALUES ('Alice'), ('Bob'), ('Charlie') as tab(name);
----
Charlie

# Test min_by with strings
query I
SELECT min_by(name, length(name)) FROM VALUES ('Alice'), ('Bob'), ('Charlie') as tab(name);
----
Bob

# Test max_by with null values
query I
SELECT max_by(x, y) FROM VALUES (1, 10), (2, null), (3, 15), (null, 8) as tab(x, y);
----
2

# Test min_by with null values
query I
SELECT min_by(x, y) FROM VALUES (1, 10), (2, null), (3, 15), (null, 8) as tab(x, y);
----
2

# Test max_by with a single value
query I
SELECT max_by(x, y) FROM VALUES (1, 10) as tab(x, y);
----
1

# Test min_by with a single value
query I
SELECT min_by(x, y) FROM VALUES (1, 10) as tab(x, y);
----
1

# Test max_by with an empty set
query I
SELECT max_by(x, y) FROM (SELECT * FROM (VALUES (1, 10)) WHERE 1=0) as tab(x, y);
----
NULL

# Test min_by with an empty set
query I
SELECT min_by(x, y) FROM (SELECT * FROM (VALUES (1, 10)) WHERE 1=0) as tab(x, y);
----
NULL